#include <stdint.h>

void blspair_g1(uint64_t x);
void blspair_g2(uint64_t x);
uint64_t blspair_pop(void);

void blssum_g1(uint64_t x);
uint64_t blssum_pop(void);

void blspair(uint64_t* g1, uint64_t* g2, uint64_t* g3) {
    int i;
    for(i=0;i<17;i++) {
        blspair_g1(g1[i]);
    }
    for(i=0;i<33;i++) {
        blspair_g2(g1[i]);
    }
    for(i=0;i<48;i++) {
        g3[i] = blspair_pop();
    }
}

void blssum(uint32_t size, uint64_t* g1, uint64_t *gr) {
    int i;
    for (i=0; i<size; i++) {
        for(i=0;i<17;i++) {
            blssum_g1(g1[i]);
        }
    }
    for(i=0;i<17;i++) {
        gr[i] = blssum_pop();
    }
}

__attribute__((visibility("default")))
int zkmain() {
    uint64_t g1[17 * 512];
    for (int i=0;i<512;i++) {
       g1[i*17 + 0] = 27727684554298117;
       g1[i*17 + 1] = 33406611288551791;
       g1[i*17 + 2] = 31701212375490422;
       g1[i*17 + 3] = 19102594710327487;
       g1[i*17 + 4] = 10492022243665489;
       g1[i*17 + 5] = 10597294227694982;
       g1[i*17 + 6] = 821352775045367;
       g1[i*17 + 7] = 0;
       g1[i*17 + 8] = 6774840762427198;
       g1[i*17 + 9] = 27398182106129606;
       g1[i*17 + 10] = 28427056486896442;
       g1[i*17 + 11] = 14306980332300968;
       g1[i*17 + 12] = 16563560983332259;
       g1[i*17 + 13] = 28743702691400222;
       g1[i*17 + 14] = 277417003125171;
       g1[i*17 + 15] = 0;
       g1[i*17 + 16] = 0;
    }

    uint64_t g2[33] = {
        34762840817961899,
        14133857073292556,
        22414852836373253,
        502022066530089,
        12950031645442569,
        21183032010887529,
        1671820736813390,
        0,
        29226365590925484,
        17549447063898391,
        15260334337785155,
        8938954488962435,
        12888700288040271,
        8852549843038421,
        1770472367437467,
        0,
        17705403109698626,
        28958912592989379,
        27969095280705330,
        25803208249835122,
        33120045669639246,
        32047886325839016,
        164505130154277,
        0,
        10910039002776808,
        2321843708721090,
        27236841301969768,
        27812794879755628,
        5690903526743227,
        24270416161660328,
        1755712830467090,
        0,
        0,
    };

    uint64_t result[96] = {
        23132918559091099,
        6278555431185042,
        23811869903087823,
        33072670874576553,
        29085321129811141,
        29606630583704090,
        705503680824730,
        0,
        14212104853500525,
        29215968650049971,
        32771885556344350,
        34552130391886104,
        21863857193792974,
        33116337720527674,
        876914689351267,
        0,
        26615538376268731,
        8961432145398794,
        22802233977457634,
        26337973029029780,
        31545052278219738,
        23271046505106824,
        725207311757587,
        0,
        8168997418951673,
        3097043071578311,
        27146336539766332,
        7178516890220708,
        8444839509142758,
        9102707185845899,
        1224491306049068,
        0,
        12187800589890395,
        16816174069348295,
        14278317460625824,
        24714147204951278,
        18194492906101909,
        27733750024057151,
        584307613088380,
        0,
        4278404317001244,
        1035890890915617,
        30771131419975105,
        7342068044743491,
        27034585615441014,
        22179383565820076,
        1328681734304479,
        0,
        20410001661190358,
        11444111165302114,
        3031120318055985,
        11540857393981000,
        29039934019594738,
        15914694280298890,
        1651278021763939,
        0,
        13191895439185194,
        13892818749631862,
        25726337066920337,
        8985925194141006,
        11833378145852924,
        29895554135355325,
        1125488991783599,
        0,
        29576933657089611,
        33497241977081086,
        14262043466897268,
        10351122590633483,
        5020076893381044,
        15303840773278951,
        717090691082148,
        0,
        35852381114840855,
        466801359697022,
        24636897764058404,
        31117857266411563,
        14306211492041446,
        15626172773023371,
        19573787387686,
        0,
        9561200042083502,
        16567920025586390,
        11164538575305242,
        27805192986787317,
        1138139845949462,
        33153712181896246,
        996906945528483,
        0,
        25463883947728618,
        24720737195557303,
        14983302909719239,
        904414990362104,
        26281294287279846,
        18796340956372003,
        952789791821024,
        0,
    };
    blspair(g1, g2, result);
    blssum(2, g1, g1);
    return 1;
}
